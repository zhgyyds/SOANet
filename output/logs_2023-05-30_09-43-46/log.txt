
------------ test options -------------
COARSE_MODEL:
  AUXILIARY_CLASS: 1
  AUXILIARY_TASK: False
  CONTEXT_BLOCK: None
  DECODER_CONV_BLOCK: ResTwoLayerConvBlock
  DECODER_NUM_BLOCK: 1
  DEEP_SUPERVISION: False
  ENCODER_CONV_BLOCK: ResFourLayerConvBlock
  INPUT_SIZE: [160, 160, 160]
  IS_DEEP_SUPERVISION: False
  IS_DYNAMIC_EMPTY_CACHE: True
  IS_POSTPROCESS: False
  IS_PREPROCESS: True
  META_ARCHITECTURE: UNet
  NUM_BLOCKS: [2, 2, 2, 2]
  NUM_CHANNELS: [8, 16, 32, 64, 128]
  NUM_CLASSES: 4
  NUM_DEPTH: 4
  WEIGHT_DIR: None
DATA_AUGMENT:
  IS_ADD_GAUSSIAN_NOISE: False
  IS_CHANGE_ROI_HU: False
  IS_ELASTIC_TRANSFORM: False
  IS_ENABLE: False
  IS_RANDOM_CROP_TO_LABELS: False
  IS_RANDOM_FLIP: False
  IS_RANDOM_ROTATE: False
  IS_RANDOM_SHIFT: False
  MAX_EXTEND_SIZE: 30
  ROI_HU_RANGE: [-50, 50]
  ROTATE_ANGLE: [-10, 10]
  SHIFT_MAX_RATIO: 0.2
DATA_LOADER:
  BAD_CASE_AUGMENT_TIMES: 2
  BAD_CASE_SERIES_IDS_TXT: None
  BATCH_SIZE: 1
  EXTEND_SIZE: 20
  FIVE_FOLD_LIST: []
  IS_COARSE: True
  IS_NORMALIZATION_DIRECTION: True
  IS_NORMALIZATION_HU: True
  LABEL_INDEX: [1, 2, 3, 4]
  LABEL_NAME: ['Liver', 'Kidney', 'Spleen', 'Pancreas']
  LABEL_NUM: [1, 2, 1, 1]
  NUM_WORKER: 2
  TEST_DB_FILE: None
  TEST_IMAGE_DIR: ./workspace/inputs/
  TEST_MASK_DIR: None
  TEST_SERIES_IDS_TXT: None
  TRAIN_DB_FILE: None
  TRAIN_VAL_FOLD: 1
  VAL_DB_FILE: None
  WINDOW_LEVEL: [-325, 325]
DATA_PREPARE:
  BAD_CASE_SERIES_IDS_TXT: None
  DEFAULT_TRAIN_DB: None
  DEFAULT_VAL_DB: None
  EXTEND_SIZE: 20
  IS_NORMALIZATION_DIRECTION: True
  IS_SMOOTH_MASK: False
  IS_SPLIT_5FOLD: False
  MASK_LABEL: [1, 2, 3, 4]
  OUT_COARSE_SIZE: [160, 160, 160]
  OUT_COARSE_SPACING: None
  OUT_DIR: None
  OUT_FINE_SIZE: [192, 192, 192]
  OUT_FINE_SPACING: None
  TEST_IMAGE_DIR: None
  TEST_MASK_DIR: None
  TEST_SERIES_IDS_TXT: None
  TRAIN_IMAGE_DIR: None
  TRAIN_MASK_DIR: None
  TRAIN_SERIES_IDS_TXT: None
  VAL_RATIO: 0.2
ENVIRONMENT:
  CUDA: True
  DATA_BASE_DIR: None
  EXPERIMENT_NAME: experiment
  INIT_METHOD: tcp://127.0.0.1:23456
  IS_SMOKE_TEST: False
  MONITOR_TIME_INTERVAL: 0.1
  NUM_GPU: 1
  PHASE: train
  RANK: 0
  SEED: 1
FINE_MODEL:
  AUXILIARY_CLASS: 1
  AUXILIARY_TASK: False
  CONTEXT_BLOCK: None
  DECODER_CONV_BLOCK: AnisotropicConvBlock
  DECODER_NUM_BLOCK: 1
  DEEP_SUPERVISION: False
  ENCODER_CONV_BLOCK: ResBaseConvBlock
  INPUT_SIZE: [192, 192, 192]
  IS_DEEP_SUPERVISION: False
  IS_DYNAMIC_EMPTY_CACHE: True
  IS_POSTPROCESS: True
  IS_PREPROCESS: True
  META_ARCHITECTURE: EfficientSegNet
  NUM_BLOCKS: [1, 1, 1, 1, 1]
  NUM_CHANNELS: [16, 32, 64, 128, 256]
  NUM_CLASSES: 4
  NUM_DEPTH: 4
  WEIGHT_DIR: None
TESTING:
  BATCH_SIZE: 1
  COARSE_MODEL_WEIGHT_DIR: ./FlareSeg/model_weights/base_coarse_model/best_model.pt
  FINE_MODEL_WEIGHT_DIR: ./FlareSeg/model_weights/efficient_fine_model/best_model.pt
  IS_FP16: False
  IS_POST_PROCESS: True
  IS_SAVE_MASK: True
  IS_SYNCHRONIZATION: True
  NUM_WORKER: 3
  OUT_RESAMPLE_MODE: 3
  SAVER_DIR: ./workspace/outputs/
TRAINING:
  ACTIVATION: sigmoid
  IS_APEX_TRAIN: True
  IS_DISTRIBUTED_TRAIN: True
  LOSS: dice
  METRIC: dice
  OPTIMIZER:
    L2_PENALTY: 5e-05
    LR: 0.001
    METHOD: adam
  SAVER:
    SAVER_DIR: ./output
    SAVER_FREQUENCY: 5
  SCHEDULER:
    LR_SCHEDULE: cosineLR
    START_EPOCH: 0
    TOTAL_EPOCHS: 60
-------------- End ----------------

load coarse model success!
Starting test...
test samples: 100
process: 0/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 0, post process start...
save fine mask complete!
batch_id: 0, fine segmentation complete!
process: 1/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 1, post process start...
save fine mask complete!
batch_id: 1, fine segmentation complete!
process: 2/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 2, post process start...
save fine mask complete!
batch_id: 2, fine segmentation complete!
process: 3/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 3, post process start...
save fine mask complete!
batch_id: 3, fine segmentation complete!
process: 4/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 4, post process start...
save fine mask complete!
batch_id: 4, fine segmentation complete!
process: 5/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 5, post process start...
save fine mask complete!
batch_id: 5, fine segmentation complete!
process: 6/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 6, post process start...
save fine mask complete!
batch_id: 6, fine segmentation complete!
process: 7/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 7, post process start...
save fine mask complete!
batch_id: 7, fine segmentation complete!
process: 8/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 8, post process start...
save fine mask complete!
batch_id: 8, fine segmentation complete!
process: 9/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 9, post process start...
save fine mask complete!
batch_id: 9, fine segmentation complete!
process: 10/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 10, post process start...
save fine mask complete!
batch_id: 10, fine segmentation complete!
process: 11/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 11, post process start...
save fine mask complete!
batch_id: 11, fine segmentation complete!
process: 12/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 12, post process start...
save fine mask complete!
batch_id: 12, fine segmentation complete!
process: 13/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 13, post process start...
save fine mask complete!
batch_id: 13, fine segmentation complete!
process: 14/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 14, post process start...
save fine mask complete!
batch_id: 14, fine segmentation complete!
process: 15/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 15, post process start...
save fine mask complete!
batch_id: 15, fine segmentation complete!
process: 16/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 16, post process start...
save fine mask complete!
batch_id: 16, fine segmentation complete!
process: 17/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 17, post process start...
save fine mask complete!
batch_id: 17, fine segmentation complete!
process: 18/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 18, post process start...
save fine mask complete!
batch_id: 18, fine segmentation complete!
process: 19/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 19, post process start...
save fine mask complete!
batch_id: 19, fine segmentation complete!
process: 20/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 20, post process start...
save fine mask complete!
batch_id: 20, fine segmentation complete!
process: 21/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 21, post process start...
save fine mask complete!
batch_id: 21, fine segmentation complete!
process: 22/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 22, post process start...
save fine mask complete!
batch_id: 22, fine segmentation complete!
process: 23/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 23, post process start...
save fine mask complete!
batch_id: 23, fine segmentation complete!
process: 24/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 24, post process start...
save fine mask complete!
batch_id: 24, fine segmentation complete!
process: 25/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 25, post process start...
save fine mask complete!
batch_id: 25, fine segmentation complete!
process: 26/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 26, post process start...
save fine mask complete!
batch_id: 26, fine segmentation complete!
process: 27/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 27, post process start...
save fine mask complete!
batch_id: 27, fine segmentation complete!
process: 28/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 28, post process start...
save fine mask complete!
batch_id: 28, fine segmentation complete!
process: 29/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 29, post process start...
save fine mask complete!
batch_id: 29, fine segmentation complete!
process: 30/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 30, post process start...
save fine mask complete!
batch_id: 30, fine segmentation complete!
process: 31/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 31, post process start...
save fine mask complete!
batch_id: 31, fine segmentation complete!
process: 32/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 32, post process start...
save fine mask complete!
batch_id: 32, fine segmentation complete!
process: 33/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 33, post process start...
save fine mask complete!
batch_id: 33, fine segmentation complete!
process: 34/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 34, post process start...
save fine mask complete!
batch_id: 34, fine segmentation complete!
process: 35/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 35, post process start...
save fine mask complete!
batch_id: 35, fine segmentation complete!
process: 36/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 36, post process start...
save fine mask complete!
batch_id: 36, fine segmentation complete!
process: 37/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 37, post process start...
save fine mask complete!
batch_id: 37, fine segmentation complete!
process: 38/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 38, post process start...
save fine mask complete!
batch_id: 38, fine segmentation complete!
process: 39/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 39, post process start...
save fine mask complete!
batch_id: 39, fine segmentation complete!
process: 40/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 40, post process start...
save fine mask complete!
batch_id: 40, fine segmentation complete!
process: 41/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 41, post process start...
save fine mask complete!
batch_id: 41, fine segmentation complete!
process: 42/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 42, post process start...
save fine mask complete!
batch_id: 42, fine segmentation complete!
process: 43/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 43, post process start...
save fine mask complete!
batch_id: 43, fine segmentation complete!
process: 44/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 44, post process start...
save fine mask complete!
batch_id: 44, fine segmentation complete!
process: 45/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 45, post process start...
save fine mask complete!
batch_id: 45, fine segmentation complete!
process: 46/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 46, post process start...
save fine mask complete!
batch_id: 46, fine segmentation complete!
process: 47/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 47, post process start...
save fine mask complete!
batch_id: 47, fine segmentation complete!
process: 48/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 48, post process start...
save fine mask complete!
batch_id: 48, fine segmentation complete!
process: 49/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 49, post process start...
save fine mask complete!
batch_id: 49, fine segmentation complete!
process: 50/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 50, post process start...
save fine mask complete!
batch_id: 50, fine segmentation complete!
process: 51/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 51, post process start...
save fine mask complete!
batch_id: 51, fine segmentation complete!
process: 52/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 52, post process start...
save fine mask complete!
batch_id: 52, fine segmentation complete!
process: 53/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 53, post process start...
save fine mask complete!
batch_id: 53, fine segmentation complete!
process: 54/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 54, post process start...
save fine mask complete!
batch_id: 54, fine segmentation complete!
process: 55/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 55, post process start...
save fine mask complete!
batch_id: 55, fine segmentation complete!
process: 56/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 56, post process start...
save fine mask complete!
batch_id: 56, fine segmentation complete!
process: 57/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 57, post process start...
save fine mask complete!
batch_id: 57, fine segmentation complete!
process: 58/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 58, post process start...
save fine mask complete!
batch_id: 58, fine segmentation complete!
process: 59/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 59, post process start...
save fine mask complete!
batch_id: 59, fine segmentation complete!
process: 60/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 60, post process start...
save fine mask complete!
batch_id: 60, fine segmentation complete!
process: 61/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 61, post process start...
save fine mask complete!
batch_id: 61, fine segmentation complete!
process: 62/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 62, post process start...
save fine mask complete!
batch_id: 62, fine segmentation complete!
process: 63/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 63, post process start...
save fine mask complete!
batch_id: 63, fine segmentation complete!
process: 64/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 64, post process start...
save fine mask complete!
batch_id: 64, fine segmentation complete!
process: 65/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 65, post process start...
save fine mask complete!
batch_id: 65, fine segmentation complete!
process: 66/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 66, post process start...
save fine mask complete!
batch_id: 66, fine segmentation complete!
process: 67/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 67, post process start...
save fine mask complete!
batch_id: 67, fine segmentation complete!
process: 68/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 68, post process start...
save fine mask complete!
batch_id: 68, fine segmentation complete!
process: 69/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 69, post process start...
save fine mask complete!
batch_id: 69, fine segmentation complete!
process: 70/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 70, post process start...
save fine mask complete!
batch_id: 70, fine segmentation complete!
process: 71/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 71, post process start...
save fine mask complete!
batch_id: 71, fine segmentation complete!
process: 72/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 72, post process start...
save fine mask complete!
batch_id: 72, fine segmentation complete!
process: 73/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 73, post process start...
save fine mask complete!
batch_id: 73, fine segmentation complete!
process: 74/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 74, post process start...
save fine mask complete!
batch_id: 74, fine segmentation complete!
process: 75/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 75, post process start...
save fine mask complete!
batch_id: 75, fine segmentation complete!
process: 76/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 76, post process start...
save fine mask complete!
batch_id: 76, fine segmentation complete!
process: 77/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 77, post process start...
save fine mask complete!
batch_id: 77, fine segmentation complete!
process: 78/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 78, post process start...
save fine mask complete!
batch_id: 78, fine segmentation complete!
process: 79/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 79, post process start...
save fine mask complete!
batch_id: 79, fine segmentation complete!
process: 80/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 80, post process start...
save fine mask complete!
batch_id: 80, fine segmentation complete!
process: 81/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 81, post process start...
save fine mask complete!
batch_id: 81, fine segmentation complete!
process: 82/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 82, post process start...
save fine mask complete!
batch_id: 82, fine segmentation complete!
process: 83/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 83, post process start...
save fine mask complete!
batch_id: 83, fine segmentation complete!
process: 84/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 84, post process start...
save fine mask complete!
batch_id: 84, fine segmentation complete!
process: 85/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 85, post process start...
save fine mask complete!
batch_id: 85, fine segmentation complete!
process: 86/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 86, post process start...
save fine mask complete!
batch_id: 86, fine segmentation complete!
process: 87/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 87, post process start...
save fine mask complete!
batch_id: 87, fine segmentation complete!
process: 88/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 88, post process start...
save fine mask complete!
batch_id: 88, fine segmentation complete!
process: 89/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 89, post process start...
save fine mask complete!
batch_id: 89, fine segmentation complete!
process: 90/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 90, post process start...
save fine mask complete!
batch_id: 90, fine segmentation complete!
process: 91/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 91, post process start...
save fine mask complete!
batch_id: 91, fine segmentation complete!
process: 92/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 92, post process start...
save fine mask complete!
batch_id: 92, fine segmentation complete!
process: 93/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 93, post process start...
save fine mask complete!
batch_id: 93, fine segmentation complete!
process: 94/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 94, post process start...
save fine mask complete!
batch_id: 94, fine segmentation complete!
process: 95/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 95, post process start...
save fine mask complete!
batch_id: 95, fine segmentation complete!
process: 96/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 96, post process start...
save fine mask complete!
batch_id: 96, fine segmentation complete!
process: 97/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 97, post process start...
save fine mask complete!
batch_id: 97, fine segmentation complete!
process: 98/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 98, post process start...
save fine mask complete!
batch_id: 98, fine segmentation complete!
process: 99/100
coarse segmentation start...
coarse segmentation complete!
fine segmentation start...
batch_id: 99, post process start...
save fine mask complete!
batch_id: 99, fine segmentation complete!
Average time usage: 2.3976560068130492 s
Normalized time coefficient: 0.9760234399318695
